% generated by plotdistinguisher.py
\documentclass[preview]{standalone}
\usepackage{comment}
\usepackage{tugcolors}
\usepackage{twine}
\usepackage[margin=2.65in]{geometry}
%\tikzset{warpfig/.append style={white}}
\begin{document}
\begin{figure}[htp!]
\begin{tikzpicture}[twinefig]
\foreach \z in {8,9,10,11,12,13,14,15} { \fill[tugred] (.25*\z,.75) circle[radius=3pt]; }
   \foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
       \draw[gray] (\z,0) node[above] {\tiny\zf};
       \foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\end{tikzpicture}
\twineroundwokey{%s
\markevenbranches{2/1}{markupperpath}{->}
\markoddbranchbeforexor{3}{markupperpath}
\markoddbranchafterxor{}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{}{markmidupperpath}{->}
\markoddbranchbeforexor{1}{markmidupperpath}
\markoddbranchafterxor{1/0}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{}
}
\twineroundwokey{%s
\markevenbranches{0/5}{markmidupperpath}{->}
\markoddbranchbeforexor{}{markmidupperpath}
\markoddbranchafterxor{1/0}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{0}
}
\twineroundwokey{%s
\markevenbranches{0/5}{markmidupperpath}{->}
\markoddbranchbeforexor{5}{markmidupperpath}
\markoddbranchafterxor{1/0,5/12}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5,2/1,4/7,6/3,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{0}
}
\twineroundwokey{%s
\markevenbranches{0/5,12/15}{markmidupperpath}{->}
\markoddbranchbeforexor{5}{markmidupperpath}
\markoddbranchafterxor{1/0,5/12,13/10}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,5/12,7/8,9/6,11/2,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{4/7,6/3,8/13,10/9,12/15}{markmidlowerpath}{<-}
\markcommonactivesboxes{0}
}
\twineroundwokey{%s
\markevenbranches{0/5,10/9,12/15}{markmidupperpath}{->}
\markoddbranchbeforexor{5,15}{markmidupperpath}
\markoddbranchafterxor{1/0,5/12,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,12,14}{markmidlowerpath}{<-}
\markoddbranch{3/4,7/8,9/6,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5,4/7,12/15}{markmidlowerpath}{<-}
\markcommonactivesboxes{6}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{5,9,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{4,6,8,10,14}{markmidlowerpath}{<-}
\markoddbranch{5/12,7/8,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{8/13,10/9}{markmidlowerpath}{<-}
\markcommonactivesboxes{7}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,5,9,11,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{8,12,14}{markmidlowerpath}{<-}
\markoddbranch{9/6,13/10}{markmidlowerpath}{<-}
\markevenbranchaftertee{14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{6}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{6,10}{markmidlowerpath}{<-}
\markoddbranch{11/2}{markmidlowerpath}{<-}
\markevenbranchaftertee{6/3}{markmidlowerpath}{<-}
\markcommonactivesboxes{5}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{2}{markmidlowerpath}{<-}
\markoddbranch{3/4}{markmidlowerpath}{<-}
\markevenbranchaftertee{}{markmidlowerpath}{<-}
\markcommonactivesboxes{1}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{4}{markmidlowerpath}{<-}
\markoddbranch{}{markmidlowerpath}{<-}
\markevenbranchaftertee{4/7}{markmidlowerpath}{<-}
\markcommonactivesboxes{}
}
\twineroundwokey{%s
\markuppercrossingdifferences{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}
\markevenbranchbeforetee{}{marklowerpath}{<-}
\markoddbranch{7/8}{marklowerpath}{<-}
\markevenbranchaftertee{6/3}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranchbeforetee{8}{marklowerpath}{<-}
\markoddbranch{3/4}{marklowerpath}{<-}
\markevenbranchaftertee{2/1,8/13}{marklowerpath}{<-}
\markoutputdiff{1,4,13}
}
\begin{tikzpicture}[twinefig]
\foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
\draw[gray] (\z,-3pt) node[below] {\tiny\zf};
\foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\foreach \z in {4,5,6,7,16,17,18,19,52,53,54,55} { \fill[tugblue] (.25*\z,-.75) circle[radius=3pt]; }
\end{tikzpicture}
\begin{comment}
#######################################################
Summary of the results:
A differential trail for EU:
Rounds	x                 pr     
--------------------------------
0	00a7000000000000  -2                
1	0a00000000000000  none              
Weight: -2.00
-------------------------------------------------------
Sandwich 10 rounds in the middle with 8 active S-boxes
-------------------------------------------------------
A linear trail for EL:
Rounds	x                 pr     
--------------------------------
0	0000000a00000000  -2                
1	000c0000a0000000  -2                
2	0200c00000000a00  none              
Weight: -4.00
#######################################################
differential effect of the upper trail: 2^(-2.00)
squared correlation of the lower trail: 2^(-4.00)
#######################################################

Total correlation = p*r*q^2 = 2^(-2.00) x r x 2^(-4.00)
2^(-18.00) <= Total correlation <= 2^(-10.00)
To compute the accurate value of total probability, r should be evaluated experimentally or using the DLCT framework

Number of attacked rounds: 13
Configuration: ru=1, rm=10, rl=2, rmu=0, rml=0, wu=1, wm=1, wl=1
\end{comment}
\caption{Differential-linear distinguisher for 13 rounds of \texttt{TWINE}.}
\label{fig:difflin_distinguisher}
\end{figure}
\end{document}
