% generated by plotdistinguisher.py
\documentclass[preview]{standalone}
\usepackage{comment}
\usepackage{tugcolors}
\usepackage{twine}
\usepackage[margin=2.65in]{geometry}
%\tikzset{warpfig/.append style={white}}
\begin{document}
\begin{figure}[htp!]
\begin{tikzpicture}[twinefig]
\foreach \z in {4,5,6,7,8,9,10,11,12,13,14,15} { \fill[tugred] (.25*\z,.75) circle[radius=3pt]; }
   \foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
       \draw[gray] (\z,0) node[above] {\tiny\zf};
       \foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\end{tikzpicture}
\twineroundwokey{%s
\markevenbranches{2/1}{markupperpath}{->}
\markoddbranchbeforexor{1,3}{markupperpath}
\markoddbranchafterxor{1/0}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{0/5}{markupperpath}{->}
\markoddbranchbeforexor{1}{markupperpath}
\markoddbranchafterxor{}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{}{markmidupperpath}{->}
\markoddbranchbeforexor{5}{markmidupperpath}
\markoddbranchafterxor{5/12}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{}
}
\twineroundwokey{%s
\markevenbranches{12/15}{markmidupperpath}{->}
\markoddbranchbeforexor{}{markmidupperpath}
\markoddbranchafterxor{13/10}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{6}
}
\twineroundwokey{%s
\markevenbranches{10/9}{markmidupperpath}{->}
\markoddbranchbeforexor{15}{markmidupperpath}
\markoddbranchafterxor{11/2,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,3/4,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5,2/1,4/7,12/15,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{5}
}
\twineroundwokey{%s
\markevenbranches{2/1,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{9}{markmidupperpath}
\markoddbranchafterxor{3/4,9/6,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,4,6,8,10,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,5/12,7/8,11/2,15/14}{markmidlowerpath}{<-}
\markevenbranchaftertee{2/1,8/13,10/9}{markmidlowerpath}{<-}
\markcommonactivesboxes{7}
}
\twineroundwokey{%s
\markevenbranches{4/7,6/3,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,11}{markmidupperpath}
\markoddbranchafterxor{1/0,5/12,7/8,11/2,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2,8,12,14}{markmidlowerpath}{<-}
\markoddbranch{1/0,9/6,13/10}{markmidlowerpath}{<-}
\markevenbranchaftertee{2/1,14/11}{markmidlowerpath}{<-}
\markcommonactivesboxes{}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,8/13,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{3,7,11}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{0,6,10}{markmidlowerpath}{<-}
\markoddbranch{1/0,11/2}{markmidlowerpath}{<-}
\markevenbranchaftertee{6/3}{markmidlowerpath}{<-}
\markcommonactivesboxes{0}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,5,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{0,2}{markmidlowerpath}{<-}
\markoddbranch{3/4}{markmidlowerpath}{<-}
\markevenbranchaftertee{0/5}{markmidlowerpath}{<-}
\markcommonactivesboxes{1}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,13}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{4}{markmidlowerpath}{<-}
\markoddbranch{5/12}{markmidlowerpath}{<-}
\markevenbranchaftertee{}{markmidlowerpath}{<-}
\markcommonactivesboxes{2}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranchbeforetee{12}{markmidlowerpath}{<-}
\markoddbranch{}{markmidlowerpath}{<-}
\markevenbranchaftertee{12/15}{markmidlowerpath}{<-}
\markcommonactivesboxes{}
}
\twineroundwokey{%s
\markuppercrossingdifferences{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}
\markevenbranchbeforetee{}{marklowerpath}{<-}
\markoddbranch{15/14}{marklowerpath}{<-}
\markevenbranchaftertee{14/11}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranchbeforetee{14}{marklowerpath}{<-}
\markoddbranch{11/2}{marklowerpath}{<-}
\markevenbranchaftertee{10/9,14/11}{marklowerpath}{<-}
\markoutputdiff{2,9,11}
}
\begin{tikzpicture}[twinefig]
\foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
\draw[gray] (\z,-3pt) node[below] {\tiny\zf};
\foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\foreach \z in {8,9,10,11,36,37,38,39,44,45,46,47} { \fill[tugblue] (.25*\z,-.75) circle[radius=3pt]; }
\end{tikzpicture}
\begin{comment}
#######################################################
Summary of the results:
A differential trail for EU:
Rounds	x                 pr     
--------------------------------
0	0a79000000000000  -2                
1	a700000000000000  -2                
2	00000a0000000000  none              
Weight: -4.00
-------------------------------------------------------
Sandwich 9 rounds in the middle with 6 active S-boxes
-------------------------------------------------------
A linear trail for EL:
Rounds	x                 pr     
--------------------------------
0	000000000000000a  -2                
1	00000000000c00a0  -2                
2	00c00000020a0000  none              
Weight: -4.00
#######################################################
differential effect of the upper trail: 2^(-4.00)
squared correlation of the lower trail: 2^(-4.00)
#######################################################

Total correlation = p*r*q^2 = 2^(-4.00) x r x 2^(-4.00)
2^(-17.00) <= Total correlation <= 2^(-11.00)
To compute the accurate value of total probability, r should be evaluated experimentally or using the DLCT framework

Number of attacked rounds: 13
Configuration: ru=2, rm=9, rl=2, rmu=0, rml=0, wu=1, wm=1, wl=1
\end{comment}
\caption{Differential-linear distinguisher for 13 rounds of \texttt{TWINE}.}
\label{fig:difflin_distinguisher}
\end{figure}
\end{document}
